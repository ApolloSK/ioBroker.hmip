"use strict";var x=Object.defineProperty;var E=Object.getOwnPropertySymbols;var A=Object.prototype.hasOwnProperty,D=Object.prototype.propertyIsEnumerable;var O=(n,s,e)=>s in n?x(n,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[s]=e,S=(n,s)=>{for(var e in s||(s={}))A.call(s,e)&&O(n,e,s[e]);if(E)for(var e of E(s))D.call(s,e)&&O(n,e,s[e]);return n};var M=(n,s)=>{var e={};for(var i in n)A.call(n,i)&&s.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&E)for(var i of E(n))s.indexOf(i)<0&&D.call(n,i)&&(e[i]=n[i]);return e};(self.webpackChunkiobroker_admin_component_hmip=self.webpackChunkiobroker_admin_component_hmip||[]).push([["node_modules_mui_system_esm_useThemeWithoutDefault_useThemeWithoutDefault_js","src_Components_jsx-node_modules_mui_system_esm_RtlProvider_index_js-node_modules_mui_system_e-44e065"],{4175:(n,s,e)=>{e.r(s),e.d(s,{default:()=>R});var i=e(8437),l=e.n(i),f=e(5973),a=e.n(f),p=e(3821),c=e(7085),h=e(5636),o=e(556),d=Object.defineProperty,u=(m,t,r)=>t in m?d(m,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):m[t]=r,C=(m,t,r)=>u(m,typeof t!="symbol"?t+"":t,r),P=(m,t,r)=>new Promise((T,v)=>{var j=_=>{try{k(r.next(_))}catch(y){v(y)}},I=_=>{try{k(r.throw(_))}catch(y){v(y)}},k=_=>_.done?T(_.value):Promise.resolve(_.value).then(j,I);k((r=r.apply(m,t)).next())});class g extends o.ConfigGeneric{constructor(t){super(t),C(this,"onAliveChanged",(r,T)=>{const v=T?T.val:!1;v!==this.state.alive&&this.setState({alive:v},()=>{v&&!this.state.initialized&&setTimeout(()=>this.setState({initialized:!0},()=>this.askState(),100))})}),Object.assign(this.state,{response:!1,running:!1,initialized:!1,alive:!1,error:!1,theme:(0,h.Theme)(this.props.themeName||"light")})}componentDidMount(){super.componentDidMount();const t=this.props.socket.getState(`hmip.${this.props.instance}.alive`);t!=null&&t.val&&this.setState({alive:!0,initialized:!0},()=>this.askState()),this.props.socket.subscribeState(`system.adapter.hmip.${this.props.instance}.alive`,this.onAliveChanged)}componentWillUnmount(){super.componentWillUnmount(),this.props.socket.unsubscribeState(`system.adapter.hmip.${this.props.instance}.alive`,this.onAliveChanged),this.askTimeout&&(clearTimeout(this.askTimeout),this.askTimeout=null)}askState(){return P(this,null,function*(){const t=yield this.props.socket.sendTo(`hmip.${this.props.instance}`,"requestTokenState",null);this.handleResponse(t)&&(this.askTimeout=this.askTimeout||setTimeout(()=>{this.askTimeout=null,this.askState()},300))})}handleResponse(t){switch(t.state){case"startedTokenCreation":return this.setState({response:"started token creation",running:!0}),!0;case"waitForBlueButton":return this.setState({response:"press blue button on accesspoint",running:!0}),!0;case"confirmToken":return this.setState({response:"confirming token",running:!0}),!0;case"errorOccurred":this.setState({response:"error occurred during token generation, look at the logs",running:!1,error:!0});break;case"idle":this.setState({response:'press "request token"',running:!1});break;case"tokenCreated":{this.setState({response:"token created, save settings to use your accesspoint",running:!1}),o.ConfigGeneric.setValue(this.props.data,"authToken",t.authToken),o.ConfigGeneric.setValue(this.props.data,"clientAuthToken",t.clientAuthToken),o.ConfigGeneric.setValue(this.props.data,"clientId",t.clientId),this.props.onChange(this.props.data,void 0,()=>this.props.forceUpdate(["authToken","clientAuthToken","clientId"],this.props.data));break}}return!1}requestToken(){return P(this,null,function*(){const t={accessPointSgtin:o.ConfigGeneric.getValue(this.props.data,"accessPointSgtin"),clientId:o.ConfigGeneric.getValue(this.props.data,"clientId"),pin:o.ConfigGeneric.getValue(this.props.data,"pin")||"",deviceName:o.ConfigGeneric.getValue(this.props.data,"deviceName")};this.setState({response:"started token creation",running:!0,error:!1});const r=yield this.props.socket.sendTo(`hmip.${this.props.instance}`,"requestToken",t);this.handleResponse(r)&&(this.askTimeout=this.askTimeout||setTimeout(()=>{this.askTimeout=null,this.askState()},300))})}renderItem(){if(!this.state.alive&&!this.state.initialized)return l().createElement(p.A,{theme:this.state.theme},l().createElement("div",{className:"hmip-admin-component"},h.I18n.t("custom_hmip_not_alive")));if(!this.state.initialized)return l().createElement(p.A,{theme:this.state.theme,className:"hmip-admin-component"},l().createElement(c.LinearProgress,null));const t=o.ConfigGeneric.getValue(this.props.data,"accessPointSgtin");return l().createElement(p.A,{theme:this.state.theme},l().createElement("div",{style:{width:"100%"},className:"hmip-admin-component"},l().createElement("div",{style:{color:this.state.error?this.props.themeType==="dark"?"#c20000":"#800000":void 0}},h.I18n.t(`custom_hmip_${this.state.response}`).replace("custom_hmip_","")),l().createElement(c.Button,{variant:"contained",color:"primary",disabled:this.state.running||!t,onClick:()=>this.requestToken()},this.state.running?l().createElement(c.CircularProgress,{size:24}):h.I18n.t("custom_hmip_request_token"))))}}g.propTypes={socket:a().object.isRequired,themeType:a().string,themeName:a().string,style:a().object,className:a().string,data:a().object.isRequired,attr:a().string,schema:a().object,onError:a().func,onChange:a().func};const R={HmipComponent:g}},9262:(n,s,e)=>{e.d(s,{A:()=>d,I:()=>o});var i=e(8437),l=e.n(i),f=e(5973),a=e.n(f),p=e(4922);const c=i.createContext();function h(P){var g=P,{value:u}=g,C=M(g,["value"]);return(0,p.jsx)(c.Provider,S({value:u!=null?u:!0},C))}const o=()=>{const u=i.useContext(c);return u!=null?u:!1},d=h},7209:(n,s,e)=>{e.d(s,{A:()=>h});var i=e(8437),l=e.n(i),f=e(5746),a=e.n(f);function p(o){return Object.keys(o).length===0}function c(o=null){const d=i.useContext(f.ThemeContext);return!d||p(d)?o:d}const h=c}}]);

//# sourceMappingURL=src_Components_jsx-node_modules_mui_system_esm_RtlProvider_index_js-node_modules_mui_system_e-44e065.d4eea41a.chunk.js.map